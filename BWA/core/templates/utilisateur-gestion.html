{% extends 'base.html' %}
{% load static %}

{% block content %}
<!-- DEBUT CONTENU -->

<div class="row mb-4 align-items-center">
    <div class="">
        <div class="card m-0 ">
            <div class="card-body px-4 py-3 py-lg-2">
                <div class="row align-items-center">
                    <div class="col-xl-4 col-md-4 col-sm-4 my-2">
                        <div class="media align-items-center style-2">
                            <span class="me-3"><i class="bi bi-person-check-fill"></i></span>
                            <div class="media-body ml-1">
                                <p class="mb-0 fs-12">Utilisateurs Actif</p>
                                <h4 class="mb-0 font-w600  fs-22">{{ nb_utilisateurs_actif }}</h4>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-4 col-md-4 col-sm-4 my-2">
                        <div class="media align-items-center style-2">
                            <span class="me-3"><i class="bi bi-person-dash-fill"></i></span>
                            <div class="media-body ml-1">
                                <p class="mb-0 fs-12">Utilisateurs non Actif</p>
                                <h4 class="mb-0 font-w600  fs-22">{{ nb_utilisateurs_inactif }}</h4>
                            </div>
                        </div>
                    </div>
                    <div class="ccol-xl-4 col-md-4 col-sm-4 my-2">
                        <div class="media align-items-center style-2">
                            <span class="me-3"><i class="bi bi-person-bounding-box"></i></span>
                            <div class="media-body ml-1">
                                <p class="mb-0 fs-12">Administrateurs</p>
                                <h4 class="mb-0 font-w600  fs-22">{{ nb_administrateurs }}</h4>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>

<div class="card mb-3" id="ordersTable">
    <div class="card-header">
        <div class="row flex-between-center">
            <div class="col-4 col-sm-auto d-flex align-items-center pe-0">
                <h5 class="fs-0 mb-0 text-nowrap py-2 py-xl-0">Utilisateur</h5>
            </div>
            <div class="col-8 col-sm-auto ms-auto text-end ps-0">
                <div id="orders-actions">
                    {% if user.is_administrateur %}
                    {% if droit_ajouter_utilisateur %}
                    <a href="{% url 'core:creation-utilisateur' %}" class="btn btn-falcon-default btn-sm" type="button">
                        <span class="fas fa-plus" data-fa-transform="shrink-3 down-2"></span>
                        <span class="d-none d-sm-inline-block ms-1">Nouveau</span>
                    </a>
                    {% else %}
                    <a class="btn btn-secondary d-block" style="cursor: default;">Nombre utilsateurs max atteint</a>
                    {% endif %}
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    <div class="card-body p-0">
        <div class="table-responsive scrollbar">
            <!-- DEBUT TABLE -->
            <table id="table_mgl" class="display">
                <thead>
                <tr>
                    <th>Utilisateur</th>
                    <th>Email</th>
                    <th>RÃ´le</th>
                    <th>Actif</th>
                    <th>Action</th>
                </tr>
                </thead>
                <tbody>
                {% for utilisateur in utilisateurs %}
                <tr>
                    <td>{{ utilisateur.full_name }}</td>
                    <td>{{ utilisateur.email }}</td>
                    <td>{{ utilisateur.group }}</td>
                    <td class="centrer">
                        {% if utilisateur.is_active %}
                        <img src="{% static 'admin/img/icon-yes.svg' %}" title="Oui">
                        {% else %}
                        <img src="{% static 'admin/img/icon-no.svg' %}" title="Non">
                        {% endif %}
                    </td>
                    <td class="centrer">
                        {% if user.is_administrateur or utilisateur.pk == user.pk %}
                        <a class="btn btn-falcon-default iconmod btn-sm" href="{% url 'core:modification-utilisateur' pk=utilisateur.pk %}"><i class="far fa-edit"></i></a>
                        {% if utilisateur.is_deletable and utilisateur != user %}
                        <a href="#" class="btn btn-falcon-default btn-sm" data-toggle="modal" data-target="#deleteModal"
                           data-action="{% url 'core:delete-utilisateur' pk=utilisateur.pk %}" data-object-name="{{ utilisateur.object_name }}">
                            <i class="far fa-trash-alt"></i>
                        </a>
                        {% else %}
                        <a href="#" class="btn btn-falcon-default btn-sm invisible"><i class="far fa-trash-alt"></i></a>
                        {% endif %}
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
                </tbody>
            </table>
            <!-- FIN TABLE -->
        </div>
    </div>
</div>
<!-- FIN CONTENU -->

{# Modale de suppression #}
{% include "modal/delete-modal.html" %}
{% endblock %}
